## 排列数

排列数表示从 $n$ 个不同元素中选出 $m$ 个元素，并对这 $m$ 个元素进行全排列的方案数。

表示方法有：

* $\mathrm A_n^m$
* $\mathrm P_n^m$

公式如下：

$$
\mathrm A_n^m = n(n-1)(n-2)\cdots(n-m+1) = \frac{n!}{(n - m)!}
$$

$n!$ 表示 $n$ 的阶乘，例如：$6! = 1\times 2\times 3\times 4\times 5\times 6$

**理解：**

将 $n$ 个人中选 $m$ 个出来排队：

* 第一个位置有 $n$ 个选法
* 第二个位置有 $n-1$ 个
* 第 $m$ 个位置有 $n-m+1$ 个

根据**乘法原理**，总方案数即为：

$$
\mathrm A_n^m = n(n-1)(n-2)\cdots(n-m+1)
$$

**实现：**

```cpp
long long A(int n, int m)
{
    if (m > n) return 0;
    long long res = 1;
    for (int i = n - m + 1; i <= n; i++)
        res = res * i;
    return res;
}
```

---

## 组合数

组合数表示从 $n$ 个不同元素中选出 $m$ 个元素，**不考虑顺序**的方案数。

常见表示方法：

* $\binom{n}{m}$（现在主流）

* $\mathrm C_n^m$

组合数计算公式：

$$
\dbinom{n}{m} = \frac{\mathrm A_n^m}{m!} = \frac{n!}{m!(n - m)!}
$$

**理解：**

先考虑顺序得到 $\mathrm A_n^m$，然后去除 $m!$ 种不同的排列顺序：

$$
\text{组合数} = \frac{\text{排列数}}{m!}
$$

当 $m > n$，规定 $\binom{n}{m}$

**实现：**

```cpp
long long C(int n, int m)
{
    if (m > n) return 0;
    long long up = 1, down = 1;
    for (int i = n - m + 1; i <= n; i++) up *= i;
    for (int i = 1; i <= m; i++) down *= i;
    return up / down;
}
```

---

## 组合数的性质

- **$\binom{n}{m}= \binom{n}{n-m}$**

从 $n$ 个中选 $m$ 个与选 $n - m$ 个是等价的（选谁留下谁都一样）。

- **杨辉三角**

组合数在杨辉三角中的表现如下：

```
1
1 1
1 2 1
1 3 3 1
1 4 6 4 1
```

- 第 $i$ 行第 $j$ 个数为 $\binom{i}{j}$
    - 注意 $i,j$ 从 $0$ 开始编号。

- **递推公式（杨辉三角递推式）：**

$$
\binom{n}{m}=\binom{n-1}{m}+\binom{n-1}{m-1}
$$

- 若选择第 $n$ 个元素，则在前 $n-1$ 中选 $m-1$ 个
- 若不选第 $n$ 个元素，则在前 $n-1$ 中选 $m$ 个
- 两种策略互不重叠是或的关系，因此根据加法原理总方案数是选和不选的方案数之和。 

**杨辉三角预处理：**

```cpp
const int N = 5005;
int c[N][N];

for (int i = 0; i <= 5000; i++)
{
    for (int j = 0; j <= i; j++)
    {
        if (j == 0 || j == i) c[i][j] = 1;
        else c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;
    }
}
```

**高精度版本：**

```cpp
vector<int> add(vector<int> &a, vector<int> &b)
{
	// 两个三位数相加最多四位数 
	int len = max(a.size(), b.size()) + 1;
	vector<int> c(len, 0); // 初始化一个长度为 len 且所有元素都是 0 的 vector 
	// c[i] = a[i] + b[i]
	for (int i = 0; i < a.size(); i++) c[i] += a[i];
	for (int i = 0; i < b.size(); i++) c[i] += b[i];
	// 进位
	for (int i = 0; i + 1 < c.size(); i++)
	{
		c[i + 1] += c[i] / 10;
		c[i] %= 10;
	}
	// 去除前导 0，删除末尾的 0，使用 vector 的 Pop_back 函数删除即可
	while (c.size() > 1 && c.back() == 0) c.pop_back();
	return c; 
}

vector<int> c[505][505];
void init()
{
    for (int i = 0; i <= 500; i++)
    {
        for (int j = 0; j <= i; j++)
        {
            if (j == 0 || j == i) c[i][j] = {1};
            else c[i][j] = add(c[i - 1][j], c[i - 1][j - 1]);
        }
    }
}
```

---

## 总结对比表

| 项目     | 排列数 $\mathrm A_n^m$ | 组合数 $\binom{n}{m}$                   |
| ------ | ---------------------- | --------------------------------------- |
| 定义     | 从 $n$ 中选 $m$ 并排序   | 从 $n$ 中选 $m$ 不排序                    |
| 是否考虑顺序 | 考虑                     | 不考虑                                     |
| 计算公式   | $\frac{n!}{(n-m)!}$  | $\frac{n!}{m!(n-m)!}$                 |
| 最大值    | 当 $m=n$ 时            | 当 $m=\lfloor n/2 \rfloor$ 时最大         |


---

