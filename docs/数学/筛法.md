
---

## ğŸ§® åŸƒå¼ç­›æ³•

**åŸç†ç®€ä»‹**

å¯¹æ¯ä¸ªå¤§äº $1$ çš„æ•´æ•° $n$ï¼Œå…¶å¤§äºè‡ªèº«çš„å€æ•°ä¸€å®šæ˜¯åˆæ•°ã€‚åŸºäºæ­¤æ€§è´¨ï¼š

* ä» $2$ å¼€å§‹æšä¸¾æ¯ä¸ªæ•° $i$ï¼Œè‹¥ $i$ æ²¡æœ‰è¢«æ ‡è®°ä¸ºåˆæ•°ï¼Œåˆ™ä¸ºè´¨æ•°ã€‚
* å°† $i$ çš„æ‰€æœ‰å€æ•°æ ‡è®°ä¸ºåˆæ•°ã€‚
* é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°ä¸Šé™ $n$ã€‚

**åŸºæœ¬å®ç°**

```cpp
bool vis[1000005]; // æ ‡è®°æ•°ç»„ï¼Œfalse è¡¨ç¤ºæ˜¯è´¨æ•°
void prime(int n) {
    vis[0] = vis[1] = true; // 0 å’Œ 1 ä¸æ˜¯è´¨æ•°
    for (int i = 2; i <= n; i++) 
    {
        if (!vis[i]) 
        {
            for (int j = i * 2; j <= n; j += i)
                vis[j] = true;
        }
    }
}
```


**åŸƒå¼ç­›æ³•ä¸ºä½•é‡å¤æ ‡è®°å¤šæ¬¡ï¼Ÿ**

- å› ä¸ºä¸€ä¸ªåˆæ•° $j$ å¯èƒ½æœ‰å¤šä¸ªè´¨å› å­ï¼Œæ˜¾ç„¶æ¯ä¸ªè´¨å› å­çš„è‹¥å¹²å€éƒ½ä¼šå°† $j$ æ ‡è®°ä¸€æ¬¡ã€‚

**ä¼˜åŒ–å®ç°**

* å†…å±‚å¾ªç¯ä» $i \times i$ å¼€å§‹ï¼Œé¿å…é‡å¤æ ‡è®°ï¼š

```cpp
bool vis[1000005];
void prime(int n) 
{
    vis[0] = vis[1] = true;
    for (int i = 2; i * i <= n; i++) 
    {
        if (!vis[i]) 
        {
            for (int j = i * i; j <= n; j += i)
                vis[j] = true;
        }
    }
}
```

**æ—¶é—´å¤æ‚åº¦ï¼š$O(n\log\log n)$**



**è°ƒå’Œçº§æ•°åˆ†æç¤ºä¾‹ï¼š**

å½¢å¦‚è¿™æ ·çš„ä»£ç ï¼Œå…¶æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯è°ƒå’Œçº§æ•°çº§åˆ«çš„ã€‚

```cpp
for (int i = 1; i <= n; i++)
    for (int j = i; j <= n; j += i)
```

æ­¤ç±»åµŒå¥—å¾ªç¯æ‰§è¡Œæ¬¡æ•°çº¦ä¸ºï¼š

$$
T(n) = n \left( \frac{1}{1} + \frac{1}{2} + \cdots + \frac{1}{n} \right) = O(n\log n)
$$

---

## ğŸš€ æ¬§æ‹‰ç­›æ³•

**æ ¸å¿ƒæ€æƒ³**

æ”¹è¿›åŸƒå¼ç­›ä¸­ **ä¸€ä¸ªåˆæ•°å¯èƒ½è¢«å¤šä¸ªè´¨å› å­æ ‡è®°** çš„é—®é¢˜ï¼Œç¡®ä¿æ¯ä¸ªåˆæ•°åªè¢«å…¶ **æœ€å°è´¨å› å­** ç­›ä¸€æ¬¡ã€‚

**ä¼˜åŠ¿**

* æ¯ä¸ªåˆæ•°åªè¢«å”¯ä¸€ä¸€æ¬¡æ ‡è®°ï¼Œ**æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$**ã€‚

**å®ç°ä»£ç **

```cpp
const int N = 1000005;
bool vis[N]; // åˆæ•°æ ‡è®°
int p[N], cnt = 0; // å­˜è´¨æ•°

void prime(int n) 
{
    vis[0] = vis[1] = true;
    for (int i = 2; i <= n; i++) 
    {
        if (!vis[i]) p[++cnt] = i; // i æ˜¯è´¨æ•°
        for (int j = 1; j <= cnt && i * p[j] <= n; j++)
        {
            vis[i * p[j]] = true;
            if (i % p[j] == 0) break; // ä¿è¯æœ€å°è´¨å› å­å”¯ä¸€
        }
    }
}
```

**åŸç†è§£é‡Š**

* æ¯ä¸ªæ•° $i$ éå†æ‰€æœ‰å°äºç­‰äº $i$ çš„è´¨æ•° $p_j$ã€‚
* è‹¥ $i \equiv 0\bmod p_j$ï¼Œè¯´æ˜ $p_j$ æ˜¯ $i$ çš„æœ€å°è´¨å› å­ï¼Œåˆ™ $i \times p_j$ åŒæ ·æœ€å°è´¨å› å­ä¸º $p_j$ï¼Œä¹‹åçš„å€æ•°äº¤ç”±æ›´å¤§æ•°å¤„ç†ã€‚

**æ‰©å±•ï¼šè®°å½•æ¯ä¸ªæ•°çš„æœ€å°è´¨å› å­**

```cpp
int f[N]; // f[i] è¡¨ç¤º i çš„æœ€å°è´¨å› å­
void prime(int n) 
{
    vis[0] = vis[1] = true;
    for (int i = 2; i <= n; i++) {
        if (!vis[i]) 
        {
            p[++cnt] = i;
            f[i] = i;
        }
        for (int j = 1; j <= cnt && i * p[j] <= n; j++) 
        {
            vis[i * p[j]] = true;
            f[i * p[j]] = p[j];
            if (i % p[j] == 0) break;
        }
    }
}
```

**åº”ç”¨åœºæ™¯**

- å¿«é€Ÿåˆ¤å®šç´ æ•°
- è·å– $[1, n]$ ä¸­æ‰€æœ‰ç´ æ•°
- å¿«é€Ÿè´¨å› æ•°åˆ†è§£
- ä½¿ç”¨ `bitset` ç»“åˆåŸƒå¼ç­›æ³•æ€§èƒ½ç”šè‡³å¿«è¿‡æ¬§æ‹‰ç­›ã€‚

---


**ğŸ“˜ å»¶ä¼¸é˜…è¯»ï¼š**

- è´¨æ•°åˆ†å¸ƒå®šç†
    - è´¨æ•°åˆ†å¸ƒå®šç†ï¼š$\pi(n) \sim n/\ln n$ï¼Œæ„æ€æ˜¯ï¼š$[1,n]$ ä»¥å†…çš„è´¨æ•°ä¸ªæ•°å¤§çº¦æ˜¯ $\frac{n}{\ln n}$ã€‚


## è¡¥å……ä¸€ï¼šé¢„å¤„ç†æœ€å¤§è´¨å› å­

åˆ©ç”¨åŸƒå¼ç­›çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ç»´æŠ¤æ¯ä¸ªæ•°å­—çš„æœ€å¤§è´¨å› å­ï¼š

```cpp
int mx[N];
bool vis[N];
for (int i = 2; i <= n; i++)
{
    if (!vis[i])
    {
        mx[i] = i;
        for (int j = i * 2; j <= n; j += i)
        {
            vis[j] = 1;
            mx[j] = i; // æœ€å¤§è´¨å› å­æ›´æ–°ä¸º i
        }
    }
}
```

---

## è¡¥å……äºŒï¼šé¢„å¤„ç†æ‰€æœ‰å› å­ / å› å­ä¸ªæ•° / å› å­å’Œ

æ€æƒ³ï¼šæšä¸¾æ¯ä¸ªæ•° $i$ï¼Œç„¶åæšä¸¾å®ƒçš„å€æ•° $j$ï¼Œåˆ™ $i$ ä¸€å®šæ˜¯ $j$ çš„å› å­ã€‚

```cpp
vector<int> fact[N];
vector<int> f(n + 1), g(n + 1); // f[i]: å› å­ä¸ªæ•°, g[i]: å› å­å’Œ
for (int i = 1; i <= n; i++)
{
    for (int j = i; j <= n; j += i)
    {
        f[j]++;
        g[j] += i;
        fact[j].push_back(i);
    }
}
```

---

## è¡¥å……ä¸‰ï¼šåŒºé—´ç­›æ³•

**åœºæ™¯**

å½“ç­›é€‰çš„åŒºé—´èŒƒå›´æ˜¯ $[L, R]$ï¼Œä¸” $R$ å¾ˆå¤§ï¼ˆå¦‚ $10^{12}$ï¼‰æ—¶ï¼Œæ™®é€šç­›æ³•æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚æ­¤æ—¶ç”¨åŒºé—´ç­›ã€‚

**åŸç†**

- å…ˆç”¨åŸƒå¼ç­›é¢„å¤„ç† $[2, \sqrt{R}]$ èŒƒå›´å†…çš„è´¨æ•°ï¼›
- åˆ›å»ºä¸€ä¸ª $R - L + 1$ å¤§å°çš„å¸ƒå°”æ•°ç»„æ ‡è®°åŒºé—´ $[L, R]$ï¼›
- æšä¸¾æ¯ä¸ªå°è´¨æ•° $p$ï¼Œç”¨å®ƒæ ‡è®° $[L, R]$ ä¸­çš„æ‰€æœ‰å€æ•°ã€‚
    - è§£é‡Šï¼š$[L,R]$ å†…çš„åˆæ•°ï¼Œå…¶æœ€å°è´¨å› å­å¿…ç„¶ $\leq \sqrt{R}$ã€‚å› æ­¤ç”¨è¿™äº›è´¨æ•° $p$ å¯ä»¥æ ‡è®°å®Œ $[L, R]$ ä¸­çš„æ‰€æœ‰åˆæ•°ã€‚

**å®ç°**

```cpp

// åŸƒå¼ç­›é¢„å¤„ç† sqrt(R) ä»¥å†…çš„è´¨æ•°
int lim = sqrt(R);
vector<bool> vis(lim + 1, false);
for (int i = 2; i <= lim; i++)
{
    if (!vis[i])
    {
        for (int j = i * 2; j <= lim; j += i)
            vis[j] = true;
    }
}
vector<int> primes;
for (int i = 2; i <= lim; i++)
    if (!vis[i])
        primes.push_back(i);


// æ ‡è®°åŒºé—´ [L, R] ä¸­åˆæ•°
vector<bool> isprime(R - L + 1, false);
for (int p : primes)
{
    long long start = max(2ll, (L + p - 1) / p) * p;
    for (long long j = start; j <= R; j += p)
        isprime[j - L] = true;
}
// ç‰¹æ®Šå¤„ç† 1
if (L == 1) isprime[0] = true;
// è¾“å‡ºæ‰€æœ‰è´¨æ•°
for (int i = 0; i <= R - L; i++)
{
    if (!isprime[i])
    {
        cout << i + L << "\n";
    }
}
```

**æ—¶é—´å¤æ‚åº¦**

$O(\sqrt{R} + (R-L+1) \log\log R)$ï¼Œç©ºé—´å¤æ‚åº¦ $O(R-L+1)$

é€‚åˆ $R-L \leq 10^6$ï¼Œä½† $R$ æœ¬èº«å¾ˆå¤§ï¼ˆå¦‚ $10^{12}$ï¼‰çš„æƒ…å†µã€‚

---

## æ€»ç»“

| æ–¹æ³•  | æ—¶é—´å¤æ‚åº¦                     | ç©ºé—´           | ç‰¹ç‚¹                       |
| --- | ------------------------- | ------------ | ------------------------ |
| åŸƒå¼ç­› | $O(n\log\log n)$        | $O(n)$     | ç»“æ„ç®€å•ï¼Œé€‚ç”¨äº $n \leq 10^7$ |
| æ¬§æ‹‰ç­› | $O(n)$                  | $O(n)$     | æ¯ä¸ªåˆæ•°åªè¢«æœ€å°è´¨å› å­ç­›ä¸€æ¬¡           |
| åŒºé—´ç­› | $O(\sqrt{R} + (R-L+1))$ | $O(R-L+1)$ | é€‚åˆ $R$ å¾ˆå¤§ï¼Œ$R-L$ å°    |




