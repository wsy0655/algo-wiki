
**éå†ä¸€å¼ å›¾ï¼Œå³éå†æ‰€æœ‰ç‚¹å’Œå‡ºè¾¹çš„æƒ…å†µã€‚**

## ğŸŒ² DFSï¼ˆæ·±åº¦ä¼˜å…ˆæœç´¢ï¼‰ç®€ä»‹

DFS å…¨ç§°æ˜¯ Depth First Searchï¼Œä¸­æ–‡åæ˜¯**æ·±åº¦ä¼˜å…ˆæœç´¢**ï¼Œæ˜¯ä¸€ç§ç”¨äºéå†æˆ–æœç´¢æ ‘æˆ–å›¾çš„ç®—æ³•ã€‚æ‰€è°“**æ·±åº¦ä¼˜å…ˆ**ï¼Œå°±æ˜¯æ¯æ¬¡éƒ½å°è¯•å‘æ›´æ·±çš„èŠ‚ç‚¹èµ°ã€‚

DFS å¸¸å¸¸ä¸ BFS å¹¶åˆ—è®²è§£ï¼Œä½†ä¸¤è€…çš„åº”ç”¨åœºæ™¯é€šå¸¸ä¸åŒã€‚è™½ç„¶å®ƒä»¬éƒ½èƒ½ç”¨äºéå†å›¾çš„è¿é€šå—ï¼Œä½†å¾ˆå°‘èƒ½äº’ç›¸æ›¿ä»£ã€‚

DFS å¸¸ç”¨äºï¼š

* è¿é€šå—éå†
* å›¾æŸ“è‰²
* æ‹“æ‰‘æ’åº
* å¼ºè¿é€šåˆ†é‡
* æœç´¢çŠ¶æ€ç©ºé—´ï¼ˆå¦‚å›æº¯ï¼‰

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼šDFS å¸¸å¸¸ç”¨é€’å½’å®ç°ï¼Œä½†â€œé€’å½’â€å’Œâ€œDFSâ€å¹¶ä¸ç­‰ä»·ï¼Œé€’å½’åªæ˜¯ DFS çš„ä¸€ç§å®ç°æ–¹å¼ã€‚

---

### ğŸ§© DFS è¿‡ç¨‹è¯´æ˜

DFS æœ€å¤§çš„ç‰¹ç‚¹æ˜¯**é€’å½’åœ°è®¿é—®æ¯ä¸ªæœªè®¿é—®çš„ç›¸é‚»èŠ‚ç‚¹**ï¼ŒåŒæ—¶ä¸ºé¿å…é‡å¤è®¿é—®ï¼Œä¼šä½¿ç”¨ä¸€ä¸ª `visited` æ•°ç»„åšæ ‡è®°ã€‚ä¼ªä»£ç å¦‚ä¸‹ï¼š

```cpp
DFS(v):
  vis[v] = true
  for u in adj[v]:
    if not vis[u]:
      DFS(u)
```

> DFS å¯ä»¥å¯¹å›¾ã€æ ‘ã€äºŒç»´ç½‘æ ¼ç­‰ç»“æ„è¿›è¡Œéå†ï¼Œä¹Ÿå¯æ‰©å±•ä¸ºå¤„ç†çŠ¶æ€å›¾ï¼ˆå¦‚åŠ¨æ€è§„åˆ’çŠ¶æ€è½¬ç§»å›¾ï¼‰ã€‚

---

### â± DFS çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦

* æ—¶é—´å¤æ‚åº¦ï¼š`O(n + m)`ï¼Œå…¶ä¸­ `n` æ˜¯èŠ‚ç‚¹æ•°ï¼Œ`m` æ˜¯è¾¹æ•°ã€‚
* ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼ˆåŒ…å«é€’å½’æ ˆç©ºé—´ï¼‰ã€‚

å›¾ç»“æ„è‹¥ç”¨é‚»æ¥çŸ©é˜µè¡¨ç¤ºï¼Œè¾¹éå†å¤æ‚åº¦å˜ä¸º `O(n^2)`ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨é‚»æ¥è¡¨æˆ–å‰å‘æ˜Ÿç»“æ„ä»¥å®ç°çº¿æ€§æ—¶é—´éå†ã€‚

> ğŸ“Œ æ³¨æ„ï¼šåœ¨æœ¬åœ°è°ƒè¯• DFS æ—¶ï¼Œæ·±é€’å½’å¯èƒ½é€ æˆæ ˆæº¢å‡ºï¼Œå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼è§£é™¤æ ˆé™åˆ¶ï¼š
>
> * Windows: ç¼–è¯‘é€‰é¡¹æ·»åŠ  `-Wl,--stack=1000000000`
> * Linux/macOS: ç»ˆç«¯è¾“å…¥ `ulimit -s unlimited`

---

### ğŸ” DFS å®ç°æ–¹å¼

#### âœ… é€’å½’å®ç°ï¼ˆé‚»æ¥è¡¨ï¼‰

```cpp
vector<int> adj[N];
bool vis[N];

void dfs(int u)
{
    vis[u] = true;
    for (int v : adj[u])
    {
        if (!vis[v])
            dfs(v);
    }
}
```

#### âœ… é“¾å¼å‰å‘æ˜Ÿå®ç°

```cpp
void dfs(int u)
{
    vis[u] = true;
    for (int i = head[u]; i; i = e[i].nxt)
    {
        int v = e[i].to;
        if (!vis[v])
            dfs(v);
    }
}
```

---

## ğŸŒŠ BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰ç®€ä»‹

BFS å…¨ç§°æ˜¯ Breadth First Searchï¼Œä¸­æ–‡åæ˜¯**å¹¿åº¦ä¼˜å…ˆæœç´¢**ã€‚

BFS æ¯æ¬¡å°è¯•è®¿é—®æ‰€æœ‰â€œåŒä¸€å±‚â€çš„èŠ‚ç‚¹ï¼Œä¹‹åå†è®¿é—®ä¸‹ä¸€å±‚ã€‚ç”±äºè¿™æ ·çš„å±‚æ¬¡æ€§ï¼Œå®ƒå¸¸è¢«ç”¨æ¥å¯»æ‰¾**æœ€çŸ­è·¯å¾„ï¼ˆè¾¹æƒä¸º 1ï¼‰**ã€‚

BFS å¯ç”¨äºï¼š

* æ±‚æ— æƒå›¾çš„æœ€çŸ­è·¯å¾„
* è¿é€šå—è®¡æ•°
* äºŒåˆ†å›¾åˆ¤å®š
* æ‹“æ‰‘æ’åº
* çŠ¶æ€ç©ºé—´æœ€çŸ­è·¯å¾„ï¼ˆå¦‚æ¸¸æˆæœ€å°æ­¥æ•°ï¼‰

---

### ğŸ§© BFS è¿‡ç¨‹è¯´æ˜

1. åˆå§‹åŒ–é˜Ÿåˆ— `q`ï¼Œå°†èµ·ç‚¹ `s` å…¥é˜Ÿï¼Œæ ‡è®°ä¸ºè®¿é—®ã€‚
2. æ¯æ¬¡å–å‡ºé˜Ÿå¤´èŠ‚ç‚¹ `u`ï¼Œè®¿é—®å…¶æ‰€æœ‰æœªè®¿é—®çš„é‚»æ¥ç‚¹ `v`ï¼š

   * `vis[v] = true`
   * `dis[v] = dis[u] + 1`ï¼Œè®°å½•åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„è·ç¦»ã€‚
   * `pre[v] = u`ï¼Œè®°å½•æ¯ä¸ªç»“ç‚¹çš„å‰é©±ã€‚
   * å…¥é˜Ÿ `v`
3. é˜Ÿåˆ—ç©ºæ—¶æœç´¢ç»“æŸã€‚

### âœ… BFS ç¤ºä¾‹ä»£ç ï¼š

```cpp
void bfs(int s)
{
    queue<int> q;
    q.push(s);
    vis[s] = true;
    dis[s] = 0;
    pre[s] = -1;

    while (!q.empty())
    {
        int u = q.front();
        q.pop();
        for (int v : e[u])
        {
            if (!vis[v])
            {
                vis[v] = true;
                dis[v] = dis[u] + 1;
                pre[v] = u;
                q.push(v);
            }
        }
    }
}
```

### ğŸ”„ è·¯å¾„è¿˜åŸå‡½æ•°

```cpp
void restore(int x)
{
    vector<int> res;
    for (int v = x; v != -1; v = pre[v])
        res.push_back(v);
    reverse(res.begin(), res.end());
    for (int v : res)
        cout << v << ' ';
}
```

---

### â± BFS çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦

* æ—¶é—´å¤æ‚åº¦ï¼š`O(n + m)`ï¼ˆæ¯ä¸ªç‚¹å’Œè¾¹å„è®¿é—®ä¸€æ¬¡ï¼‰
* ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`ï¼ˆvis\[] + é˜Ÿåˆ—ï¼‰

---

### ğŸ›  BFS å…¸å‹åº”ç”¨åœºæ™¯

* âœ… æ±‚æœ€çŸ­è·¯å¾„ï¼ˆè¾¹æƒ=1ï¼‰
* âœ… æ±‚å›¾çš„è¿é€šå—æ•°é‡
* âœ… æ±‚æœ€çŸ­è·¯ä¸Šçš„æ‰€æœ‰è¾¹/ç‚¹
* âœ… åˆ¤æ–­çŠ¶æ€æ˜¯å¦å¯è¾¾ï¼ˆä¾‹å¦‚è§£è¿·å®«ï¼‰
* âœ… æ— æƒæœ‰å‘å›¾ä¸­æ±‚æœ€å°ç¯ï¼ˆä»æ¯ä¸ªç‚¹åš BFSï¼‰
* âœ… æ‰¾ä¸€æ¡å¶æ•°é•¿åº¦æœ€çŸ­è·¯ï¼ˆæ‹†ç‚¹å»ºæ–°å›¾ï¼‰
* âœ… 0/1 æƒå›¾æ±‚æœ€çŸ­è·¯ï¼ˆè§ä¸‹æ–‡ï¼‰

---

## âš–ï¸ åŒç«¯é˜Ÿåˆ— BFSï¼ˆ0-1 BFSï¼‰

é€‚ç”¨äº**è¾¹æƒä¸º 0 æˆ– 1** çš„æœ€çŸ­è·¯é—®é¢˜ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

* è‹¥è¾¹æƒä¸º 0ï¼Œå°†æ–°èŠ‚ç‚¹åŠ å…¥é˜Ÿé¦–
* è‹¥è¾¹æƒä¸º 1ï¼Œå°†æ–°èŠ‚ç‚¹åŠ å…¥é˜Ÿå°¾

è¿™æ ·å¯ä»¥ç¡®ä¿é˜Ÿåˆ—ä¸­èŠ‚ç‚¹çš„ä»£ä»·å•è°ƒé€’å¢ï¼Œä»è€Œç¡®ä¿æ­£ç¡®çš„æœ€çŸ­è·¯å¾„ã€‚

### ğŸ”€ æ¨¡æ¿ä¼ªä»£ç ï¼š

```cpp
while (!dq.empty())
{
    u = dq.front();
    dq.pop_front();
    for (é‚»å±… v)
    {
        if (ç”¨ 0 èŠ±è´¹æ›´æ–° v): 
        dq.push_front(v);
        else
            dq.push_back(v);
    }
}
```

### ğŸ“Œ ä¾‹é¢˜ï¼šæ´›è°· P4554 å°æ˜çš„æ¸¸æˆ

é¢˜æ„ï¼šå°æ˜æœ€è¿‘å–œæ¬¢ç©ä¸€ä¸ªæ¸¸æˆã€‚ç»™å®šä¸€ä¸ª $n \times m$ çš„æ£‹ç›˜ï¼Œä¸Šé¢æœ‰ä¸¤ç§æ ¼å­ `#` å’Œ `@`ã€‚æ¸¸æˆçš„è§„åˆ™å¾ˆç®€å•ï¼šç»™å®šä¸€ä¸ªèµ·å§‹ä½ç½®å’Œä¸€ä¸ªç›®æ ‡ä½ç½®ï¼Œå°æ˜æ¯ä¸€æ­¥èƒ½å‘ä¸Šï¼Œä¸‹ï¼Œå·¦ï¼Œå³å››ä¸ªæ–¹å‘ç§»åŠ¨ä¸€æ ¼ã€‚å¦‚æœç§»åŠ¨åˆ°åŒä¸€ç±»å‹çš„æ ¼å­ï¼Œåˆ™è´¹ç”¨æ˜¯ $0$ï¼Œå¦åˆ™è´¹ç”¨æ˜¯ $1$ã€‚è¯·ç¼–ç¨‹è®¡ç®—ä»èµ·å§‹ä½ç½®ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®çš„æœ€å°èŠ±è´¹ã€‚

ä»£ç é‡‡ç”¨ `0-1 BFS`ï¼šä¸‹ä¸€ä¸ªä½ç½®å’Œå½“å‰ç›¸åŒä»£ä»·ä¸º $0$ï¼Œæ”¹å˜åˆ™ä»£ä»·ä¸º $1$ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
char a[505][505];
int dis[505][505];
int dx[] = {1, 0, -1, 0};
int dy[] = {0, 1, 0, -1};
int main()
{
    while (1)
    {
        memset(dis, -1, sizeof(dis));
        int n, m;
        cin >> n >> m;
        if (n == 0 && m == 0)
        {
            return 0;
        }
        for (int i = 0; i < n; i++)
        {
            for (int j = 0; j < m; j++)
            {
                cin >> a[i][j];
            }
        }
        int x1, x2, y1, y2;
        cin >> x1 >> y1 >> x2 >> y2;
        deque<array<int, 2>> q;
        q.push_front({x1, y1});
        dis[x1][y1] = 0;
        while (q.size())
        {
            auto b = q.front();
            q.pop_front();
            for (int i = 0; i < 4; i++)
            {
                int nx = b[0] + dx[i];
                int ny = b[1] + dy[i];
                if (nx >= 0 && ny >= 0 && nx < n && ny < m && dis[nx][ny] == -1)
                {
                    dis[nx][ny] = dis[b[0]][b[1]];
                    if (a[nx][ny] == a[b[0]][b[1]])
                    {
                        q.push_front({nx, ny});
                    }
                    else
                    {
                        q.push_back({nx, ny});
                        dis[nx][ny]++;
                    }
                }
            }
        }
        cout << dis[x2][y2] << '\n';
    }
    return 0;
}
```

---

## ğŸ§® ä¼˜å…ˆé˜Ÿåˆ— BFSï¼ˆå †ä¼˜åŒ–ï¼‰

ä¼˜å…ˆé˜Ÿåˆ— BFS ä½¿ç”¨æœ€å°å †æ¥é€‰æ‹©å½“å‰æ€»ä»£ä»·æœ€å°çš„èŠ‚ç‚¹è¿›è¡Œæ‰©å±•ï¼Œå…·æœ‰è´ªå¿ƒæ€§è´¨ã€‚

å…¶åŸç†ä¸ Dijkstra ååˆ†ç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå¯ä»¥æ‰©å±•åˆ°æŸäº›çŠ¶æ€å›¾é—®é¢˜ï¼ˆä¾‹å¦‚å¤šç»´çŠ¶æ€è½¬ç§»ï¼‰ï¼Œå¹¶éè¦æ±‚è¾¹æƒéè´Ÿå›¾ã€‚

ä¼˜å…ˆé˜Ÿåˆ—çš„ BFS ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯èƒ½å¤šæ¬¡å…¥é˜Ÿï¼Œä½†åªåœ¨ç¬¬ä¸€æ¬¡å‡ºé˜Ÿæ—¶å¤„ç†ã€‚

### âœ… ä¼˜åŠ¿

* å¯å¤„ç†å¤æ‚çŠ¶æ€æœ€çŸ­è·¯å¾„é—®é¢˜
* å¸¸ç”¨äºæ‹“å±• Dijkstra ä¹‹å¤–çš„é—®é¢˜æ¨¡å‹

### â± å¤æ‚åº¦

* æ—¶é—´å¤æ‚åº¦ï¼š`O((n + m) * log n)`ï¼ˆæ¯ä¸ªèŠ‚ç‚¹å…¥é˜Ÿä¸€æ¬¡ + log æ“ä½œï¼‰

---

> âœ… æ€»ç»“ï¼š
>
> * DFSï¼šé€‚ç”¨äºæ·±åº¦æœç´¢ã€æ ‘å½¢ç»“æ„ã€å›æº¯ç­‰
> * BFSï¼šé€‚ç”¨äºæ— æƒå›¾çš„æœ€çŸ­è·¯å¾„ã€å±‚æ¬¡éå†
> * 0-1 BFSï¼šé€‚ç”¨äºè¾¹æƒä¸º 0/1 çš„æœ€çŸ­è·¯å¾„
> * ä¼˜å…ˆé˜Ÿåˆ— BFSï¼šçŠ¶æ€å›¾æœ€çŸ­è·¯å¾„ã€å¤æ‚å»ºæ¨¡

æ¬¢è¿åœ¨å®è·µä¸­æ ¹æ®é¢˜æ„çµæ´»é€‰æ‹©æœ€é€‚åˆçš„æœç´¢ç­–ç•¥ ğŸŒŸ
